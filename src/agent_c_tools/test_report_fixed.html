<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Viewer</title>
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <!-- Load additional languages -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/csharp.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/java.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/xml.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/languages/json.min.js"></script>
    
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked@4.0.0/marked.min.js"></script>
    
    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    
    <style>
        :root {
            --primary-color: #0366d6;
            --sidebar-width: 300px;
            --sidebar-min-width: 100px;
            --sidebar-max-width: 600px;
            --sidebar-bg: #f6f8fa;
            --border-color: #e1e4e8;
            --code-bg: #f6f8fa;
            --text-color: #24292e;
            --heading-color: #24292e;
            --link-color: #0366d6;
            --folder-icon-color: #79b8ff;
            --file-icon-color: #959da5;
            --toggle-btn-color: #586069;
            --toggle-btn-hover-color: #24292e;
            --resize-handle-width: 8px;
            --fullscreen-bg: rgba(0, 0, 0, 0.8);
            --z-index-fullscreen: 1000;
            --z-index-drag-handle: 10;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }
        
        #sidebar {
            width: var(--sidebar-width);
            min-width: var(--sidebar-min-width);
            max-width: var(--sidebar-max-width);
            height: 100%;
            overflow-y: auto;
            background-color: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
            box-sizing: border-box;
            transition: transform 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }
        
        #sidebar-resize-handle {
            position: absolute;
            top: 0;
            right: -5px;
            width: var(--resize-handle-width);
            height: 100%;
            cursor: col-resize;
            z-index: var(--z-index-drag-handle);
        }
        
        #content {
            flex-grow: 1;
            height: 100%;
            overflow-y: auto;
            padding: 20px 40px;
            box-sizing: border-box;
        }
        
        #sidebar-toggle {
            position: absolute;
            right: 10px;
            top: 10px;
            background-color: var(--sidebar-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 5px 8px;
            cursor: pointer;
            color: var(--toggle-btn-color);
            font-weight: bold;
            font-size: 14px;
            z-index: 5;
            transition: color 0.3s ease;
        }
        
        #sidebar-toggle:hover {
            color: var(--toggle-btn-hover-color);
        }
        
        .tree-view {
            list-style-type: none;
            padding-left: 15px;
            margin: 0;
        }
        
        .tree-view li {
            margin: 5px 0;
            position: relative;
        }
        
        .folder {
            cursor: pointer;
            user-select: none;
            padding: 5px 8px;
            border-radius: 3px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
        }
        
        .folder:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }
        
        .folder:before {
            content: 'üìÅ';
            margin-right: 8px;
            color: var(--folder-icon-color);
        }

        .folder.open:before {
            content: 'üìÇ';
        }

        .file {
            padding: 5px 8px;
            cursor: pointer;
            user-select: none;
            border-radius: 3px;
            display: flex;
            align-items: center;
        }

        .file:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .file:before {
            content: 'üìÑ';
            margin-right: 8px;
            color: var(--file-icon-color);
        }
        
        .file.active {
            background-color: rgba(3, 102, 214, 0.1);
            color: var(--primary-color);
            font-weight: 500;
        }
        
        .hidden {
            display: none;
        }
        
        /* Markdown content styling */
        #markdown-content h1 {
            padding-bottom: 0.3em;
            font-size: 2em;
            border-bottom: 1px solid var(--border-color);
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: var(--heading-color);
        }
        
        #markdown-content h2 {
            padding-bottom: 0.3em;
            font-size: 1.5em;
            border-bottom: 1px solid var(--border-color);
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: var(--heading-color);
        }
        
        #markdown-content h3 {
            font-size: 1.25em;
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
            color: var(--heading-color);
        }
        
        #markdown-content a {
            color: var(--link-color);
            text-decoration: none;
        }
        
        #markdown-content a:hover {
            text-decoration: underline;
        }
        
        #markdown-content code {
            font-family: SFMono-Regular, Consolas, Liberation Mono, Menlo, monospace;
            padding: 0.2em 0.4em;
            margin: 0;
            font-size: 85%;
            background-color: var(--code-bg);
            border-radius: 3px;
        }
        
        #markdown-content pre {
            background-color: var(--code-bg);
            border-radius: 6px;
            padding: 16px;
            overflow: auto;
            margin-top: 0;
            margin-bottom: 16px;
        }
        
        #markdown-content pre code {
            padding: 0;
            margin: 0;
            background-color: transparent;
            font-size: 85%;
            line-height: 1.5;
            display: block;
            overflow-x: auto;
        }
        
        #markdown-content blockquote {
            padding: 0 1em;
            color: #6a737d;
            border-left: 0.25em solid #dfe2e5;
            margin: 0 0 16px 0;
        }
        
        #markdown-content table {
            display: block;
            width: 100%;
            overflow: auto;
            border-spacing: 0;
            border-collapse: collapse;
            margin-top: 0;
            margin-bottom: 16px;
        }
        
        #markdown-content table tr {
            background-color: #fff;
            border-top: 1px solid #c6cbd1;
        }
        
        #markdown-content table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }
        
        #markdown-content table th, #markdown-content table td {
            padding: 6px 13px;
            border: 1px solid #dfe2e5;
        }
        
        #markdown-content table th {
            font-weight: 600;
        }
        
        /* Method signature specific styling */
        #markdown-content pre code.hljs {
            padding: 16px;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', 'Andale Mono', 'Ubuntu Mono', monospace;
        }
        
        /* C# specific styles */
        #markdown-content .hljs-keyword {
            color: #0000ff;
            font-weight: bold;
        }
        
        #markdown-content .hljs-type,
        #markdown-content .hljs-class {
            color: #267f99;
        }
        
        #markdown-content .hljs-string {
            color: #a31515;
        }
        
        #markdown-content .hljs-function {
            color: #795e26;
        }
        
        /* Method documentation styling */
        #markdown-content .method-description {
            margin-bottom: 24px;
            padding-left: 16px;
            border-left: 4px solid #e1e4e8;
        }
        
        /* Full screen overlay for images and diagrams */
        .fullscreen-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--fullscreen-bg);
            z-index: var(--z-index-fullscreen);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }
        
        .fullscreen-content {
            max-width: 95%;
            max-height: 90%;
            overflow: auto;
            background-color: white;
            padding: 10px;
            border-radius: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .fullscreen-content img {
            max-width: 100%;
            max-height: 85vh;
            object-fit: contain;
        }
        
        .fullscreen-content .mermaid {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
        }
        
        .fullscreen-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 30px;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.5);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1;
        }
        
        .fullscreen-trigger {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(0, 0, 0, 0.2);
            color: white;
            padding: 5px;
            border-radius: 3px;
            cursor: pointer;
            display: none;
            font-size: 16px;
            z-index: 10;
        }
        
        #markdown-content .mermaid-wrapper {
            position: relative;
            margin-bottom: 16px;
        }
        
        #markdown-content .mermaid-wrapper:hover .fullscreen-trigger,
        #markdown-content p:has(img):hover .fullscreen-trigger {
            display: block;
        }
        
        #markdown-content p:has(img) {
            position: relative;
            display: inline-block;
        }
        
        /* Responsive layout */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            
            #sidebar {
                width: 100% !important; /* Override any inline styles */
                height: auto;
                max-height: 30vh;
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            #sidebar-resize-handle {
                display: none;
            }
            
            #content {
                height: auto;
                max-height: 70vh;
            }
            
            .fullscreen-content {
                max-width: 100%;
                max-height: 80vh;
            }
        }
    </style>
</head>
<body>
    <div id="sidebar">
		<button id="sidebar-toggle" title="Toggle Sidebar">.</button> <!--Hide button, disabling for now-->
        <div id="sidebar-resize-handle" title="Drag to resize"></div>
        <h3 style="margin: 0 16px 16px 16px;">Fixed Test Report</h3>
		<div><svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">
  <!-- Orange concentric arcs (target/bullseye) -->
  <path d="M250 150 A100 100 0 0 0 150 250 A100 100 0 0 0 250 350" stroke="#FF6A00" stroke-width="30" fill="none" />
  <path d="M250 180 A70 70 0 0 0 180 250 A70 70 0 0 0 250 320" stroke="#FF6A00" stroke-width="20" fill="none" />
  
  <!-- Purple center circle -->
  <circle cx="250" cy="250" r="40" fill="#4B0082" />
  
  <!-- Connecting lines and nodes -->
  <line x1="290" y1="250" x2="350" y2="250" stroke="#4B0082" stroke-width="10" />
  <circle cx="350" cy="250" r="15" fill="#4B0082" />
  
  <line x1="277" y1="213" x2="327" y2="163" stroke="#4B0082" stroke-width="10" />
  <circle cx="327" cy="163" r="15" fill="#4B0082" />
  
  <line x1="277" y1="287" x2="327" y2="337" stroke="#4B0082" stroke-width="10" />
  <circle cx="327" cy="337" r="15" fill="#4B0082" />
  
  <line x1="250" y1="290" x2="250" y2="350" stroke="#4B0082" stroke-width="10" />
  <circle cx="250" cy="350" r="15" fill="#4B0082" />
  
  <!-- Text: "AGENT C" -->
  <text x="250" y="420" font-family="Arial, sans-serif" font-weight="bold" font-size="60" fill="#4B0082" text-anchor="middle">AGENT C</text>
  
  <!-- Text: "CENTRIC CONSULTING" -->
  <text x="250" y="460" font-family="Arial, sans-serif" font-weight="bold" font-size="24" fill="#4B0082" text-anchor="middle">CENTRIC CONSULTING</text>
</svg></div>
        <ul id="tree-view" class="tree-view"></ul>
    </div>
    <div id="content">
        <div id="markdown-content"></div>
    </div>
    
    <script>
        // File structure will be injected here by the generator script
        const fileStructure = [{"name": "Markdown To Html Enhancements", "type": "file", "path": "markdown_to_html_enhancements.md", "content": "# Markdown to HTML Report Tool Enhancement Ideas\n\n## Current Tool Overview\n\nThe current tool does a good job of:\n\n- Collecting markdown files from a workspace directory\n- Building a navigable file structure\n- Converting markdown to HTML using Marked.js\n- Supporting syntax highlighting via Highlight.js\n- Rendering Mermaid diagrams\n- Providing a responsive UI with sidebar navigation\n- Handling internal links between markdown files\n- Adding fullscreen view for images and diagrams\n\n## Enhancement Opportunities\n\nHere are several ways we could enhance the tool to add more interactivity and visual polish:\n\n### 1. Interactive Data Visualization\n\n**Implementation:**\n\n- Integrate Chart.js or D3.js via CDN\n- Support custom code fences for charts: \n  \n  ```\n  ```chart\n  {\n    \"type\": \"bar\",\n    \"data\": { ... }\n  }\n  ```\n  \n  ```\n- Process this during markdown rendering to generate interactive charts\n\n**Benefits:**\n\n- Makes data visualization dynamic and interactive\n- Allows agents to present data findings more effectively\n- Supports hover effects, tooltips, and animations\n\n**Sample Implementation:**\n\n```javascript\n// Add to the HTML template head section\n<script src=\"https://cdn.jsdelivr.net/npm/chart.js\"></script>\n\n// In the markdown processing logic\nconst renderer = new marked.Renderer();\nrenderer.code = function(code, language) {\n  if (language === 'chart') {\n    try {\n      const chartConfig = JSON.parse(code);\n      const chartId = 'chart-' + Math.random().toString(36).substring(2);\n      setTimeout(() => {\n        const ctx = document.getElementById(chartId).getContext('2d');\n        new Chart(ctx, chartConfig);\n      }, 0);\n      return `<div class=\"chart-container\"><canvas id=\"${chartId}\"></canvas></div>`;\n    } catch (e) {\n      return `<pre><code class=\"hljs\">Error parsing chart: ${e.message}</code></pre>`;\n    }\n  }\n  // Default code block handling\n  // ...\n};\n```\n\n### 2. Tabbed Content\n\n**Implementation:**\n\n- Add support for a simple syntax like:\n  \n  ```\n  :::tabs\n  ::tab Python\n  ```python\n  print(\"Hello World\")\n  ```\n  \n  ::tab JavaScript\n  \n  ```javascript\n  console.log(\"Hello World\");\n  ```\n  \n  :::\n  ```\n- Process this custom syntax during rendering to create tab interfaces\n\n**Benefits:**\n\n- Provides a cleaner way to compare different code samples\n- Reduces vertical scrolling for alternative solutions\n- Especially useful for multi-language code examples\n\n**Sample Implementation:**\n\n```javascript\n// CSS for tabs\n.tabs-container {\n  margin: 1em 0;\n}\n.tabs-header {\n  display: flex;\n  border-bottom: 1px solid #ccc;\n}\n.tab-button {\n  padding: 0.5em 1em;\n  border: none;\n  background: none;\n  cursor: pointer;\n}\n.tab-button.active {\n  border-bottom: 2px solid #0366d6;\n}\n.tab-content {\n  display: none;\n  padding: 1em 0;\n}\n.tab-content.active {\n  display: block;\n}\n\n// Custom markdown processing for tabs\nfunction processTabsInMarkdown(markdown) {\n  const tabsRegex = /:::tabs\\s*\\n([\\s\\S]*?):::/g;\n  const tabRegex = /::tab\\s+(.+?)\\n([\\s\\S]*?)(?=::tab|:::)/g;\n\n  return markdown.replace(tabsRegex, (match, tabsContent) => {\n    let tabsHtml = '<div class=\"tabs-container\"><div class=\"tabs-header\">';\n    let tabsContentHtml = '';\n    let tabId = 'tabs-' + Math.random().toString(36).substring(2);\n    let firstTab = true;\n\n    let tabMatch;\n    let tabIndex = 0;\n    while ((tabMatch = tabRegex.exec(tabsContent + '::')) !== null) {\n      const [_, tabName, tabContent] = tabMatch;\n      const currentTabId = `${tabId}-${tabIndex}`;\n\n      tabsHtml += `<button class=\"tab-button ${firstTab ? 'active' : ''}\" \n                        data-tab=\"${currentTabId}\">${tabName}</button>`;\n\n      tabsContentHtml += `<div class=\"tab-content ${firstTab ? 'active' : ''}\" \n                           id=\"${currentTabId}\">${marked(tabContent)}</div>`;\n\n      firstTab = false;\n      tabIndex++;\n    }\n\n    return tabsHtml + '</div>' + tabsContentHtml + '</div>';\n  });\n}\n\n// Add JavaScript to handle tab switching\nfunction setupTabs() {\n  document.querySelectorAll('.tab-button').forEach(button => {\n    button.addEventListener('click', () => {\n      const tabContainer = button.closest('.tabs-container');\n\n      // Deactivate all tabs\n      tabContainer.querySelectorAll('.tab-button').forEach(b => \n        b.classList.remove('active'));\n      tabContainer.querySelectorAll('.tab-content').forEach(c => \n        c.classList.remove('active'));\n\n      // Activate the clicked tab\n      button.classList.add('active');\n      const tabId = button.getAttribute('data-tab');\n      document.getElementById(tabId).classList.add('active');\n    });\n  });\n}\n\n// Call setupTabs after the document is loaded\ndocument.addEventListener('DOMContentLoaded', setupTabs);\n```\n\n### 3. Collapsible Content Sections\n\n**Implementation:**\n\n- Support syntax like:\n  \n  ```\n  :::details Advanced Options\n  This content is initially hidden but can be expanded.\n  :::\n  ```\n- Use JavaScript to toggle visibility\n\n**Benefits:**\n\n- Helps manage information density\n- Allows users to focus on the most relevant content\n- Useful for hiding verbose logs or detailed explanations\n\n**Sample Implementation:**\n\n```javascript\n// CSS for collapsible sections\n.details-container {\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  margin: 1em 0;\n}\n.details-summary {\n  padding: 0.5em 1em;\n  cursor: pointer;\n  background-color: #f5f5f5;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n.details-summary::after {\n  content: '+';\n  font-weight: bold;\n}\n.details-container.open .details-summary::after {\n  content: '-';\n}\n.details-content {\n  padding: 1em;\n  display: none;\n}\n.details-container.open .details-content {\n  display: block;\n}\n\n// Custom markdown processing\nfunction processDetailsInMarkdown(markdown) {\n  const detailsRegex = /:::details\\s+(.+?)\\n([\\s\\S]*?):::/g;\n\n  return markdown.replace(detailsRegex, (match, summary, content) => {\n    const detailId = 'details-' + Math.random().toString(36).substring(2);\n    return `\n      <div class=\"details-container\" id=\"${detailId}\">\n        <div class=\"details-summary\">${summary}</div>\n        <div class=\"details-content\">${marked(content)}</div>\n      </div>\n    `;\n  });\n}\n\n// Add JavaScript to handle toggling\nfunction setupCollapsibleSections() {\n  document.querySelectorAll('.details-summary').forEach(summary => {\n    summary.addEventListener('click', () => {\n      const container = summary.closest('.details-container');\n      container.classList.toggle('open');\n    });\n  });\n}\n\n// Call after the document is loaded\ndocument.addEventListener('DOMContentLoaded', setupCollapsibleSections);\n```\n\n### 4. Math Equation Support\n\n**Implementation:**\n\n- Add KaTeX or MathJax via CDN\n- Support LaTeX math notation in markdown:\n  \n  ```\n  The formula is $E = mc^2$ and the equation is:\n  $$\n  \\frac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n  $$\n  ```\n\n**Benefits:**\n\n- Proper rendering of mathematical equations\n- Essential for technical and scientific reports\n\n**Sample Implementation:**\n\n```html\n<!-- Add to HTML template head -->\n<link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css\">\n<script src=\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js\"></script>\n\n<!-- Add after markdown is rendered -->\n<script>\n  document.addEventListener(\"DOMContentLoaded\", function() {\n    renderMathInElement(document.body, {\n      delimiters: [\n        {left: \"$$\", right: \"$$\", display: true},\n        {left: \"$\", right: \"$\", display: false}\n      ],\n      throwOnError: false\n    });\n  });\n</script>\n```\n\n### 5. Dark Mode Toggle\n\n**Implementation:**\n\n- Add CSS variables for light/dark themes\n- Include a theme toggle button\n- Store preference in localStorage\n\n**Benefits:**\n\n- Improves readability based on user preference and environment\n- Reduces eye strain in low-light settings\n\n**Sample Implementation:**\n\n```html\n<!-- Add to CSS -->\n<style>\n  :root {\n    --bg-color: #ffffff;\n    --text-color: #333333;\n    --sidebar-bg: #f5f5f5;\n    --code-bg: #f5f5f5;\n    --border-color: #ddd;\n    --link-color: #0366d6;\n  }\n\n  [data-theme=\"dark\"] {\n    --bg-color: #222;\n    --text-color: #eee;\n    --sidebar-bg: #333;\n    --code-bg: #333;\n    --border-color: #555;\n    --link-color: #58a6ff;\n  }\n\n  body {\n    background-color: var(--bg-color);\n    color: var(--text-color);\n  }\n\n  .sidebar {\n    background-color: var(--sidebar-bg);\n    border-color: var(--border-color);\n  }\n\n  pre, code {\n    background-color: var(--code-bg);\n    border-color: var(--border-color);\n  }\n\n  a {\n    color: var(--link-color);\n  }\n\n  /* More styles using variables */\n</style>\n\n<!-- Add theme toggle button to header -->\n<button id=\"theme-toggle\" aria-label=\"Toggle dark mode\">\n  <svg id=\"moon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path d=\"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z\"></path>\n  </svg>\n  <svg id=\"sun\" xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <circle cx=\"12\" cy=\"12\" r=\"5\"></circle>\n    <line x1=\"12\" y1=\"1\" x2=\"12\" y2=\"3\"></line>\n    <line x1=\"12\" y1=\"21\" x2=\"12\" y2=\"23\"></line>\n    <line x1=\"4.22\" y1=\"4.22\" x2=\"5.64\" y2=\"5.64\"></line>\n    <line x1=\"18.36\" y1=\"18.36\" x2=\"19.78\" y2=\"19.78\"></line>\n    <line x1=\"1\" y1=\"12\" x2=\"3\" y2=\"12\"></line>\n    <line x1=\"21\" y1=\"12\" x2=\"23\" y2=\"12\"></line>\n    <line x1=\"4.22\" y1=\"19.78\" x2=\"5.64\" y2=\"18.36\"></line>\n    <line x1=\"18.36\" y1=\"5.64\" x2=\"19.78\" y2=\"4.22\"></line>\n  </svg>\n</button>\n\n<!-- Add JavaScript for theme switching -->\n<script>\n  document.addEventListener('DOMContentLoaded', () => {\n    const themeToggle = document.getElementById('theme-toggle');\n    const moonIcon = document.getElementById('moon');\n    const sunIcon = document.getElementById('sun');\n\n    // Check for saved theme preference or get from OS\n    const savedTheme = localStorage.getItem('theme') || \n      (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');\n\n    // Apply the theme\n    if (savedTheme === 'dark') {\n      document.documentElement.setAttribute('data-theme', 'dark');\n      moonIcon.style.display = 'none';\n      sunIcon.style.display = 'block';\n    } else {\n      moonIcon.style.display = 'block';\n      sunIcon.style.display = 'none';\n    }\n\n    // Toggle theme when button is clicked\n    themeToggle.addEventListener('click', () => {\n      const currentTheme = document.documentElement.getAttribute('data-theme');\n      const newTheme = currentTheme === 'dark' ? 'light' : 'dark';\n\n      document.documentElement.setAttribute('data-theme', newTheme);\n      localStorage.setItem('theme', newTheme);\n\n      if (newTheme === 'dark') {\n        moonIcon.style.display = 'none';\n        sunIcon.style.display = 'block';\n      } else {\n        moonIcon.style.display = 'block';\n        sunIcon.style.display = 'none';\n      }\n    });\n  });\n</script>\n```\n\n### 6. Search Functionality\n\n**Implementation:**\n\n- Add a search input in the header\n- Use Lunr.js or a similar library for client-side search\n- Highlight matches in the content\n\n**Benefits:**\n\n- Makes finding specific information much faster\n- Particularly valuable in lengthy documentation\n\n**Sample Implementation:**\n\n```html\n<!-- Add to HTML template head -->\n<script src=\"https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js\"></script>\n\n<!-- Add search input to header -->\n<div class=\"search-container\">\n  <input type=\"text\" id=\"search-input\" placeholder=\"Search...\" />\n  <div id=\"search-results\" class=\"search-results\"></div>\n</div>\n\n<!-- Add JavaScript for search functionality -->\n<script>\n  document.addEventListener('DOMContentLoaded', () => {\n    // Build search index\n    const searchIndex = lunr(function() {\n      this.ref('id');\n      this.field('title');\n      this.field('content');\n\n      // Create a document for each content section\n      document.querySelectorAll('.content-section').forEach((section, index) => {\n        const title = section.querySelector('h1, h2, h3, h4, h5, h6')?.textContent || '';\n        const content = section.textContent;\n        this.add({\n          id: index,\n          title: title,\n          content: content,\n          element: section\n        });\n      });\n    });\n\n    const searchInput = document.getElementById('search-input');\n    const searchResults = document.getElementById('search-results');\n\n    searchInput.addEventListener('input', () => {\n      const query = searchInput.value;\n      if (query.length < 2) {\n        searchResults.innerHTML = '';\n        searchResults.style.display = 'none';\n        return;\n      }\n\n      const results = searchIndex.search(query);\n      if (results.length === 0) {\n        searchResults.innerHTML = '<div class=\"no-results\">No results found</div>';\n        searchResults.style.display = 'block';\n        return;\n      }\n\n      searchResults.innerHTML = results.map(result => {\n        const item = document.getElementById(result.ref);\n        const title = item.querySelector('h1, h2, h3, h4, h5, h6')?.textContent || 'Untitled';\n        return `\n          <div class=\"search-result-item\" data-ref=\"${result.ref}\">\n            <h4>${title}</h4>\n            <p>${item.textContent.substring(0, 150)}...</p>\n          </div>\n        `;\n      }).join('');\n\n      searchResults.style.display = 'block';\n\n      // Add click handlers to search results\n      document.querySelectorAll('.search-result-item').forEach(item => {\n        item.addEventListener('click', () => {\n          const ref = item.getAttribute('data-ref');\n          const element = document.getElementById(ref);\n          element.scrollIntoView({ behavior: 'smooth' });\n          searchResults.style.display = 'none';\n        });\n      });\n    });\n\n    // Close search results when clicking outside\n    document.addEventListener('click', (e) => {\n      if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {\n        searchResults.style.display = 'none';\n      }\n    });\n  });\n</script>\n```\n\n### 7. Enhanced Tables\n\n**Implementation:**\n\n- Add DataTables.js support for markdown tables\n- Enable sorting, filtering, and pagination for tables that opt-in\n\n**Benefits:**\n\n- Makes large data tables much more usable\n- Provides advanced data exploration capabilities\n\n**Sample Implementation:**\n\n```html\n<!-- Add to HTML template head -->\n<link rel=\"stylesheet\" href=\"https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css\">\n<script src=\"https://code.jquery.com/jquery-3.6.0.min.js\"></script>\n<script src=\"https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js\"></script>\n\n<!-- Add to markdown processing -->\n<script>\n  function enhanceTables() {\n    // Look for tables with a special class or attribute\n    document.querySelectorAll('table[data-enhanced=\"true\"]').forEach(table => {\n      $(table).DataTable({\n        paging: true,\n        searching: true,\n        ordering: true\n      });\n    });\n  }\n\n  // Add a custom syntax for enhanced tables in the markdown processor\n  // Example: \n  // :::enhanced-table\n  // | Header 1 | Header 2 |\n  // | -------- | -------- |\n  // | Data 1   | Data 2   |\n  // :::\n\n  function processEnhancedTablesInMarkdown(markdown) {\n    const tableRegex = /:::enhanced-table\\s*\\n([\\s\\S]*?):::/g;\n\n    return markdown.replace(tableRegex, (match, tableContent) => {\n      // Process the table with standard markdown\n      const processed = marked(tableContent);\n\n      // Add the data-enhanced attribute\n      return processed.replace('<table>', '<table data-enhanced=\"true\">');\n    });\n  }\n\n  document.addEventListener('DOMContentLoaded', enhanceTables);\n</script>\n```\n\n### 8. PDF Export\n\n**Implementation:**\n\n- Add html2pdf.js via CDN\n- Include an export button in the header\n\n**Benefits:**\n\n- Creates shareable documents from the HTML viewer\n- Provides offline access to content\n\n**Sample Implementation:**\n\n```html\n<!-- Add to HTML template head -->\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js\"></script>\n\n<!-- Add export button to header -->\n<button id=\"export-pdf\" class=\"export-button\">Export as PDF</button>\n\n<!-- Add JavaScript for PDF export -->\n<script>\n  document.addEventListener('DOMContentLoaded', () => {\n    const exportButton = document.getElementById('export-pdf');\n\n    exportButton.addEventListener('click', () => {\n      // Get the current document title or use default\n      const title = document.querySelector('h1')?.textContent || 'Document';\n\n      // Get the content element (excluding sidebar)\n      const content = document.querySelector('#content');\n\n      // Configure PDF options\n      const options = {\n        margin: [10, 10, 10, 10],\n        filename: `${title.replace(/[^a-z0-9]/gi, '_').toLowerCase()}.pdf`,\n        image: { type: 'jpeg', quality: 0.98 },\n        html2canvas: { scale: 2 },\n        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }\n      };\n\n      // Generate the PDF\n      html2pdf().from(content).set(options).save();\n    });\n  });\n</script>\n```\n\n### 9. Copy Code Button\n\n**Implementation:**\n\n- Add a \"Copy\" button to the top-right of each code block\n- Use the Clipboard API to copy code to clipboard\n\n**Benefits:**\n\n- Simplifies the process of using provided code examples\n- Eliminates manual selection and potential copy errors\n\n**Sample Implementation:**\n\n```javascript\n// CSS for copy button\n.code-block {\n  position: relative;\n}\n.copy-button {\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  padding: 3px 8px;\n  font-size: 12px;\n  background: rgba(0, 0, 0, 0.3);\n  color: white;\n  border: none;\n  border-radius: 3px;\n  cursor: pointer;\n  opacity: 0;\n  transition: opacity 0.2s;\n}\n.code-block:hover .copy-button {\n  opacity: 1;\n}\n.copy-button:hover {\n  background: rgba(0, 0, 0, 0.5);\n}\n\n// JavaScript to add copy buttons to code blocks\nfunction addCopyButtons() {\n  document.querySelectorAll('pre code').forEach((codeBlock) => {\n    const container = codeBlock.parentNode;\n    container.classList.add('code-block');\n\n    const copyButton = document.createElement('button');\n    copyButton.className = 'copy-button';\n    copyButton.textContent = 'Copy';\n\n    copyButton.addEventListener('click', () => {\n      navigator.clipboard.writeText(codeBlock.textContent)\n        .then(() => {\n          // Visual feedback\n          copyButton.textContent = 'Copied!';\n          setTimeout(() => {\n            copyButton.textContent = 'Copy';\n          }, 2000);\n        })\n        .catch(err => {\n          console.error('Failed to copy code: ', err);\n          copyButton.textContent = 'Error!';\n          setTimeout(() => {\n            copyButton.textContent = 'Copy';\n          }, 2000);\n        });\n    });\n\n    container.appendChild(copyButton);\n  });\n}\n\ndocument.addEventListener('DOMContentLoaded', addCopyButtons);\n```\n\n## Implementation Approach\n\nTo integrate these enhancements:\n\n1. **Update HTML Template**: Modify the template to include additional CSS/JS libraries via CDN\n2. **Enhance Markdown Processing**: Add custom processors for special syntax\n3. **Extend Marked.js Renderer**: Customize the renderer to handle our extensions\n4. **Add UI Controls**: Include buttons and controls for new interactive features\n\nThis approach maintains the simplicity of markdown as the input format while significantly enhancing the output's interactivity and visual appeal. The beauty is that authors only need to learn minimal additional syntax to leverage these powerful features.\n\n## Implementation Priority\n\nSuggested implementation order based on impact and complexity:\n\n1. Copy Code Button (high impact, low complexity)\n2. Dark Mode Toggle (high impact, medium complexity)\n3. Tabbed Content (high impact, medium complexity)\n4. Collapsible Content Sections (high impact, medium complexity)\n5. Interactive Data Visualization (high impact, high complexity)\n6. Math Equation Support (medium impact, low complexity)\n7. Enhanced Tables (medium impact, medium complexity)\n8. Search Functionality (medium impact, high complexity)\n9. PDF Export (medium impact, medium complexity)\n\n## Next Steps\n\n1. Review the proposed enhancements and prioritize based on user needs\n2. Implement a prototype with 2-3 of the highest priority features\n3. Test with actual markdown content from agent outputs\n4. Gather feedback and refine the implementation\n5. Document the extended markdown syntax for agent developers\n6. Roll out the enhanced viewer as part of the standard toolkit"}, {"name": "Test Markdown", "type": "file", "path": "test_markdown.md", "content": "# Test Markdown File\n\nThis is a test markdown file to verify the markdown to HTML tool is working correctly."}];
        
        // DOM elements
        const treeView = document.getElementById('tree-view');
        const markdownContent = document.getElementById('markdown-content');
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const sidebarResizeHandle = document.getElementById('sidebar-resize-handle');
        const content = document.getElementById('content');
        
        // Get saved sidebar width from localStorage or use default
        const savedSidebarWidth = localStorage.getItem('sidebarWidth');
        if (savedSidebarWidth) {
            sidebar.style.width = savedSidebarWidth + 'px';
        }
        
        // Toggle sidebar
        let sidebarHidden = false;
        sidebarToggle.addEventListener('click', () => {
            sidebarHidden = !sidebarHidden;
            
            if (sidebarHidden) {
                const currentWidth = sidebar.offsetWidth;
                localStorage.setItem('lastSidebarWidth', currentWidth);
                sidebar.style.width = '0';
                sidebarToggle.textContent = 'Show';
                sidebarToggle.style.right = '10px';
                sidebarToggle.style.position = 'fixed';
                sidebarResizeHandle.style.display = 'none';
            } else {
                const lastWidth = localStorage.getItem('lastSidebarWidth') || 300;
                sidebar.style.width = lastWidth + 'px';
                sidebarToggle.textContent = 'Hide';
                sidebarToggle.style.right = '10px';
                sidebarToggle.style.position = 'absolute';
                sidebarResizeHandle.style.display = 'block';
            }
        });
        
        // Implement sidebar resize functionality
        let isResizing = false;
        
        sidebarResizeHandle.addEventListener('mousedown', function(e) {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
            document.addEventListener('mousemove', handleMouseMove);
            document.addEventListener('mouseup', stopResize);
            // Prevent selection during resize
            e.preventDefault();
        });
        
        function handleMouseMove(e) {
            if (!isResizing) return;
            
            let newWidth = e.clientX;
            
            // Apply constraints
            if (newWidth < parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-min-width'))) {
                newWidth = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-min-width'));
            }
            
            if (newWidth > parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-max-width'))) {
                newWidth = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--sidebar-max-width'));
            }
            
            sidebar.style.width = newWidth + 'px';
            localStorage.setItem('sidebarWidth', newWidth);
        }
        
        function stopResize() {
            isResizing = false;
            document.body.style.cursor = '';
            document.removeEventListener('mousemove', handleMouseMove);
            document.removeEventListener('mouseup', stopResize);
        }
        
        // Configure marked for proper rendering
        marked.setOptions({
            highlight: function(code, lang) {
                if (lang && hljs.getLanguage(lang)) {
                    try {
                        return hljs.highlight(code, { language: lang }).value;
                    } catch (e) {
                        console.error(e);
                    }
                }
                return hljs.highlightAuto(code).value;
            },
            langPrefix: 'hljs language-',
            headerIds: true,
            mangle: false,
            pedantic: false,
            gfm: true,
            breaks: false,
            sanitize: false,
            smartLists: true,
            smartypants: false,
            xhtml: false
        });
        
        // Custom renderer to handle mermaid diagrams
        const renderer = new marked.Renderer();
        const originalCodeRenderer = renderer.code.bind(renderer);
        const originalImageRenderer = renderer.image.bind(renderer);
        
        renderer.code = function (code, language, escaped) {
            if (language === 'mermaid') {
                return `<div class="mermaid-wrapper">
                            <div class="fullscreen-trigger" onclick="openFullscreen(this.nextElementSibling)">‚õ∂</div>
                            <div class="mermaid">${code}</div>
                        </div>`;
            }
            return originalCodeRenderer(code, language, escaped);
        };
        
        renderer.image = function(href, title, text) {
            const img = originalImageRenderer(href, title, text);
            return `<span style="position: relative; display: inline-block;">
                        <span class="fullscreen-trigger" onclick="openFullscreen(this.nextElementSibling)">‚õ∂</span>
                        ${img}
                    </span>`;
        };
        
        marked.use({ renderer });
        
        // Function to open fullscreen view
        window.openFullscreen = function(element) {
            // Create overlay
            const overlay = document.createElement('div');
            overlay.className = 'fullscreen-overlay';
            
            // Create content container
            const content = document.createElement('div');
            content.className = 'fullscreen-content';
            
            // Create close button
            const closeBtn = document.createElement('div');
            closeBtn.className = 'fullscreen-close';
            closeBtn.innerHTML = '√ó';
            closeBtn.onclick = function() {
                document.body.removeChild(overlay);
            };
            
            // Clone the element to show in fullscreen
            const clone = element.cloneNode(true);
            
            // Handle different element types
            if (element.tagName === 'IMG') {
                // For images, create a new img element
                const img = document.createElement('img');
                img.src = element.src;
                img.alt = element.alt;
                content.appendChild(img);
            } else if (element.classList.contains('mermaid')) {
                // For mermaid diagrams
                clone.removeAttribute('style'); // Remove any inline styles
                content.appendChild(clone);
                
                // Re-render the mermaid diagram
                setTimeout(() => {
                    mermaid.init(undefined, [clone]);
                }, 100);
            }
            
            // Add elements to the DOM
            overlay.appendChild(closeBtn);
            overlay.appendChild(content);
            document.body.appendChild(overlay);
            
            // Close on escape key
            document.addEventListener('keydown', function escHandler(e) {
                if (e.key === 'Escape') {
                    document.body.removeChild(overlay);
                    document.removeEventListener('keydown', escHandler);
                }
            });
            
            // Close on click outside the content
            overlay.addEventListener('click', function(e) {
                if (e.target === overlay) {
                    document.body.removeChild(overlay);
                }
            });
        };
        
        // Function to create the tree view
        function createTreeView(structure, parent) {
            structure.forEach(item => {
                const li = document.createElement('li');
                
                if (item.type === 'folder') {
                    // Create folder
                    const folderElement = document.createElement('div');
                    folderElement.classList.add('folder');
                    folderElement.textContent = item.name;
                    li.appendChild(folderElement);
                    
                    // Create child list for this folder
                    const ul = document.createElement('ul');
                    ul.classList.add('tree-view', 'hidden');
                    li.appendChild(ul);
                    
                    // Toggle visibility on click
                    folderElement.addEventListener('click', (e) => {
                        e.stopPropagation();
                        folderElement.classList.toggle('open');
                        ul.classList.toggle('hidden');
                    });
                    
                    // If there are children, create their views
                    if (item.children && item.children.length > 0) {
                        createTreeView(item.children, ul);
                        
                        // Auto-expand folders with only one sub-folder
                        if (item.children.length === 1 && item.children[0].type === 'folder') {
                            folderElement.classList.add('open');
                            ul.classList.remove('hidden');
                        }
                    }
                } else {
                    // Create file
                    // Only show markdown files
                    if (item.name.toLowerCase().endsWith('.md') || item.name.toLowerCase().endsWith('.markdown')) {
                        const fileElement = document.createElement('div');
                        fileElement.classList.add('file');
                        fileElement.textContent = item.name;
                        fileElement.dataset.path = item.path;
                        fileElement.dataset.content = item.content;
                        li.appendChild(fileElement);
                        
                        // Handle file click to display content
                        fileElement.addEventListener('click', (e) => {
                            e.stopPropagation();
                            // Remove active from all files
                            document.querySelectorAll('.file.active').forEach(el => {
                                el.classList.remove('active');
                            });
                            // Add active to this file
                            fileElement.classList.add('active');
                            
                            // Render markdown content
                            renderMarkdown(fileElement.dataset.content);
                            
                            // Update browser history to allow back/forward navigation
                            updateHistory(item.path);
                            
                            // On mobile, collapse sidebar after selection
                            if (window.innerWidth <= 768) {
                                sidebarHidden = true;
                                sidebar.style.maxHeight = '40px';
                                sidebar.style.overflow = 'hidden';
                            }
                        });
                    } else {
                        // Skip non-markdown files
                        return;
                    }
                }
                
                parent.appendChild(li);
            });
        }
        
        // Function to render markdown
        function renderMarkdown(content) {
            markdownContent.innerHTML = marked.parse(content);
            
            // Initialize mermaid diagrams
            if (window.mermaid) {
                mermaid.initialize({
                    startOnLoad: false,
                    theme: 'default',
                    securityLevel: 'loose',
                    logLevel: 5
                });
                
                try {
                    mermaid.init(undefined, document.querySelectorAll('.mermaid'));
                } catch (error) {
                    console.error('Mermaid initialization failed:', error);
                }
            }
            
            // Highlight all code blocks
            document.querySelectorAll('pre code').forEach((block) => {
                hljs.highlightElement(block);
            });
            
            // Process links in the rendered content
            document.querySelectorAll('#markdown-content a').forEach(link => {
                // For external links, add target="_blank"
                if (link.hostname !== window.location.hostname) {
                    link.setAttribute('target', '_blank');
                    link.setAttribute('rel', 'noopener noreferrer');
                }
                
                // For internal anchor links (that weren't processed by the Python script)
                // These could be generated by the markdown renderer from headings
                if (link.hash && link.href.startsWith(window.location.href.split('#')[0])) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        const anchorId = link.hash.substring(1);
                        scrollToAnchor(anchorId);
                    });
                }
            });
            
            // Scroll to hash if present
            if (window.location.hash) {
                const element = document.getElementById(window.location.hash.substring(1));
                if (element) {
                    element.scrollIntoView();
                }
            }
        }
        
        // Function to update browser history
        function updateHistory(filePath) {
            const url = new URL(window.location);
            url.searchParams.set('file', filePath);
            window.history.pushState({filePath: filePath}, '', url);
        }
        
        // Function to open a markdown file by path
        function openMarkdownFile(filePath, anchor = '') {
            // Check if this is a directory path (no file extension or ends with /)
            if (filePath.endsWith('/') || !filePath.includes('.')) {
                // Try to find the first markdown file in this directory
                const directoryPath = filePath.endsWith('/') ? filePath : filePath + '/';
                
                // Look through all file elements to find one in this directory
                const fileElements = document.querySelectorAll('.file[data-path]');
                for (const element of fileElements) {
                    if (element.dataset.path.startsWith(directoryPath)) {
                        // Found a file in this directory, open it
                        return openMarkdownFile(element.dataset.path, anchor);
                    }
                }
            }
            
            const fileElement = document.querySelector(`[data-path="${filePath}"]`);
            if (fileElement) {
                // Set active class
                document.querySelectorAll('.file.active').forEach(el => {
                    el.classList.remove('active');
                });
                fileElement.classList.add('active');
                
                // Render content
                renderMarkdown(fileElement.dataset.content);
                
                // Update history
                updateHistory(filePath);
                
                // Expand parent folders
                let parent = fileElement.parentElement;
                while (parent) {
                    if (parent.tagName === 'UL' && parent.classList.contains('tree-view')) {
                        parent.classList.remove('hidden');
                        const folderDiv = parent.previousElementSibling;
                        if (folderDiv && folderDiv.classList.contains('folder')) {
                            folderDiv.classList.add('open');
                        }
                    }
                    parent = parent.parentElement;
                }
                
                // Scroll to anchor if provided
                if (anchor) {
                    const element = document.getElementById(anchor.substring(1));
                    if (element) {
                        setTimeout(() => {
                            element.scrollIntoView();
                        }, 100);
                    }
                }
                
                return true;
            }
            return false;
        }
        
        // Function to find file in structure by path
        function findFileInStructure(structure, path) {
            for (const item of structure) {
                if (item.type === 'file' && item.path === path) {
                    return item;
                } else if (item.type === 'folder' && item.children) {
                    const found = findFileInStructure(item.children, path);
                    if (found) return found;
                }
            }
            return null;
        }
        
        // Function to find and display first markdown file
        function findAndDisplayFirstMarkdownFile(structure) {
            const findFirstMdFile = (items) => {
                for (const item of items) {
                    if (item.type === 'file' && (item.name.toLowerCase().endsWith('.md') || item.name.toLowerCase().endsWith('.markdown'))) {
                        return item;
                    } else if (item.type === 'folder' && item.children && item.children.length > 0) {
                        const found = findFirstMdFile(item.children);
                        if (found) return found;
                    }
                }
                return null;
            };
            
            // Check URL parameters first
            const urlParams = new URLSearchParams(window.location.search);
            const fileParam = urlParams.get('file');
            
            if (fileParam) {
                const fileItem = findFileInStructure(structure, fileParam);
                if (fileItem) {
                    setTimeout(() => {
                        openMarkdownFile(fileItem.path);
                    }, 100);
                    return;
                }
            }
            
            // If no file in URL or not found, display first file
            const firstMdFile = findFirstMdFile(structure);
            if (firstMdFile) {
                setTimeout(() => {
                    openMarkdownFile(firstMdFile.path);
                }, 100);
            } else {
                markdownContent.innerHTML = '<h1>No markdown files found</h1>';
            }
        }
        
        // Handle browser back/forward navigation
        window.addEventListener('popstate', (event) => {
            if (event.state && event.state.filePath) {
                openMarkdownFile(event.state.filePath);
            } else {
                // If no state, open first file
                findAndDisplayFirstMarkdownFile(fileStructure);
            }
        });
        
        // Initialize the viewer
        function initializeViewer() {
            // Create the tree view
            createTreeView(fileStructure, treeView);
            
            // Auto-open the first markdown file
            findAndDisplayFirstMarkdownFile(fileStructure);
        }
        
        // Function to scroll to an anchor within the current document
        function scrollToAnchor(anchorId) {
            const element = document.getElementById(anchorId);
            if (element) {
                element.scrollIntoView({behavior: 'smooth'});
                // Highlight the element briefly
                const originalBackgroundColor = element.style.backgroundColor;
                element.style.backgroundColor = 'rgba(255, 255, 0, 0.3)';
                setTimeout(() => {
                    element.style.backgroundColor = originalBackgroundColor;
                }, 1500);
            } else {
                console.warn(`Anchor with id '${anchorId}' not found`);
            }
        }
        
        // Make functions globally available
        window.openMarkdownFile = openMarkdownFile;
        window.scrollToAnchor = scrollToAnchor;
        
        // Start the application
        window.addEventListener('DOMContentLoaded', initializeViewer);
    </script>
</body>
</html>